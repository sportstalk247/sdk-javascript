!function(){var e,t,n,r={};Object.defineProperty(r,"__esModule",{value:!0}),r.EventModerationState=r.ChatOptionsEventType=r.CustomEventTypes=r.EventType=void 0,(n=r.EventType||(r.EventType={})).speech="speech",n.purge="purge",n.mute="mute",n.banned="banned",n.bounce="bounce",n.reaction="reaction",n.replace="replace",n.remove="remove",n.roomClosed="roomclosed",n.roomOpen="roomopened",n.action="action",n.reply="reply",n.quote="quote",n.ad="ad",n.exit="exit",n.enter="enter",n.announcement="announcement",n.custom="custom",r.CustomEventTypes={goal:"goal"},(t=r.ChatOptionsEventType||(r.ChatOptionsEventType={})).announcement="announcement",t.custom="custom",t.ad="ad",(e=r.EventModerationState||(r.EventModerationState={})).na="na",e.approved="approved",e.rejected="rejected";var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.PUT=o.DELETE=o.GET=o.POST=o.DEFAULT_CONFIG=o.AUTHORIZATION_HEADER=o.API_TOKEN_HEADER=o.APPLICATION_JSON=o.FORM_ENCODED=o.DEFAULT_ENDPOINT=void 0,o.DEFAULT_ENDPOINT="https://api.sportstalk247.com/api/v3",o.FORM_ENCODED="application/x-www-form-urlencoded",o.APPLICATION_JSON="application/json",o.API_TOKEN_HEADER="x-api-token",o.AUTHORIZATION_HEADER="Authorization",o.DEFAULT_CONFIG={endpoint:o.DEFAULT_ENDPOINT,smoothEventUpdates:!0},Object.freeze(o.DEFAULT_CONFIG),o.POST="POST",o.GET="GET",o.DELETE="DELETE",o.PUT="PUT";var i,s={},a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(s,"__esModule",{value:!0}),s.RequireUserError=s.SettingsError=s.ValidationError=void 0;var u=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r.name="ValidationError",r}return a(t,e),t}(Error);s.ValidationError=u;var c=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r.name="SettingsError",r}return a(t,e),t}(Error);s.SettingsError=c;var d=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r.name="RequireUserError",r}return a(t,e),t}(Error);s.RequireUserError=d;var f={},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},h=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};function v(e){var t=[];for(var n in e){var r=n;if(void 0!==e[n]&&null!==e[n]&&NaN!==e[n]){var o=encodeURIComponent(e[n]);t.push(r+"="+o)}}return t.join("&")}Object.defineProperty(f,"__esModule",{value:!0}),f.CallBackDelegate=f.forceObjKeyOrString=f.getJSONHeaders=f.getUrlEncodedHeaders=f.buildAPI=f.queryStringify=f.formify=void 0,f.formify=v,f.queryStringify=function e(t,n){var r=[];for(var o in t){var i=n||o;if(void 0!==t[o]&&null!==t[o]&&NaN!==t[o])if(Array.isArray(t[o]))r.push(e(t[o],o));else{var s=encodeURIComponent(t[o]);r.push(i+"="+s)}}return r.join("&")},f.buildAPI=function(e,t,n){var r=(e.endpoint||o.DEFAULT_CONFIG.endpoint)+"/"+e.appId+"/"+t;return n&&Object.keys(n).length>0&&(r=r+"?"+v(n)),r},f.getUrlEncodedHeaders=function(e,t){var n={"Content-Type":o.FORM_ENCODED};return e&&(n[o.API_TOKEN_HEADER]=e),t&&(n[o.AUTHORIZATION_HEADER]=t),n},f.getJSONHeaders=function(e,t){var n={"Content-Type":o.APPLICATION_JSON};return e&&(n[o.API_TOKEN_HEADER]=e),t&&(n[o.AUTHORIZATION_HEADER]="Bearer "+t),n},f.forceObjKeyOrString=function(e,t){void 0===t&&(t="id");var n=e[t]||e;if("string"==typeof n)return n;throw new s.ValidationError("Missing required string property "+t)};var p=function(e,t){var n=this;this.callback=function(e){return l(n,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return[4,this._func.call(this._target,e)];case 1:return t=n.sent(),this._target.setUserToken(t),[2,t]}}))}))},this.setCallback=function(e){n._func=e},this._target=e,this._func=t};f.CallBackDelegate=p;var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.THROTTLE_ERROR=m.USER_NEEDS_ID=m.REQUIRE_ROOM_ID=m.NO_ROOM_SET=m.NO_HANDLER_SET=m.NO_CONVERSATION_SET=m.MUST_SPECIFY_CONVERSATION=m.MUST_SET_USER=m.MISSING_ROOM=m.MISSING_REPLYTO_ID=void 0,m.MISSING_REPLYTO_ID="Need a replyto message ID to reply",m.MISSING_ROOM="Need to join a room first!",m.MUST_SET_USER="Must set user",m.MUST_SPECIFY_CONVERSATION="Must set a comments in method call or set a default",m.NO_CONVERSATION_SET="Need to set a valid conversation with a conversationid",m.NO_HANDLER_SET="No event handler set",m.NO_ROOM_SET="No room set.  You must join a room before you can get updates!",m.REQUIRE_ROOM_ID="Room must have an id",m.USER_NEEDS_ID="User needs an ID",m.THROTTLE_ERROR="405 - Not Allowed. Please wait to send this message again";var _=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},g=Object.prototype.toString;function y(e){return"[object Array]"===g.call(e)}function b(e){return void 0===e}function E(e){return null!==e&&"object"==typeof e}function S(e){if("[object Object]"!==g.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function T(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),y(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}var R={isArray:y,isArrayBuffer:function(e){return"[object ArrayBuffer]"===g.call(e)},isBuffer:function(e){return null!==e&&!b(e)&&null!==e.constructor&&!b(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:E,isPlainObject:S,isUndefined:b,isDate:function(e){return"[object Date]"===g.call(e)},isFile:function(e){return"[object File]"===g.call(e)},isBlob:function(e){return"[object Blob]"===g.call(e)},isStream:function(e){return E(e)&&function(e){return"[object Function]"===g.call(e)}(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:T,merge:function e(){var t={};function n(n,r){S(t[r])&&S(n)?t[r]=e(t[r],n):S(n)?t[r]=e({},n):y(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)T(arguments[r],n);return t},extend:function(e,t,n){return T(t,(function(t,r){e[r]=n&&"function"==typeof t?_(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}};function w(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var O=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(R.isURLSearchParams(t))r=t.toString();else{var o=[];R.forEach(t,(function(e,t){null!=e&&(R.isArray(e)?t+="[]":e=[e],R.forEach(e,(function(e){R.isDate(e)?e=e.toISOString():R.isObject(e)&&(e=JSON.stringify(e)),o.push(w(t)+"="+w(e))})))})),r=o.join("&")}if(r){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e},C={};function U(){this.handlers=[]}U.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},U.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},U.prototype.forEach=function(e){R.forEach(this.handlers,(function(t){null!==t&&e(t)}))},C=U;var k,j,I,P=function(e,t){R.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))},A=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},H=function(e,t,n,r,o){var i=new Error(e);return A(i,t,n,r,o)},x=R.isStandardBrowserEnv()?{write:function(e,t,n,r,o,i){var s=[];s.push(e+"="+encodeURIComponent(t)),R.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),R.isString(r)&&s.push("path="+r),R.isString(o)&&s.push("domain="+o),!0===i&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},N=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],q=R.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=R.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0},D=function(e){return new Promise((function(t,n){var r=e.data,o=e.headers,i=e.responseType;R.isFormData(r)&&delete o["Content-Type"];var s=new XMLHttpRequest;if(e.auth){var a=e.auth.username||"",u=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.Authorization="Basic "+btoa(a+":"+u)}var c,d,f=(c=e.baseURL,d=e.url,c&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(d)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(c,d):d);function l(){if(s){var r="getAllResponseHeaders"in s?(a=s.getAllResponseHeaders(),f={},a?(R.forEach(a.split("\n"),(function(e){if(d=e.indexOf(":"),u=R.trim(e.substr(0,d)).toLowerCase(),c=R.trim(e.substr(d+1)),u){if(f[u]&&N.indexOf(u)>=0)return;f[u]="set-cookie"===u?(f[u]?f[u]:[]).concat([c]):f[u]?f[u]+", "+c:c}})),f):f):null,o={data:i&&"text"!==i&&"json"!==i?s.response:s.responseText,status:s.status,statusText:s.statusText,headers:r,config:e,request:s};(function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(H("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)})(t,n,o),s=null}var a,u,c,d,f}if(s.open(e.method.toUpperCase(),O(f,e.params,e.paramsSerializer),!0),s.timeout=e.timeout,"onloadend"in s?s.onloadend=l:s.onreadystatechange=function(){s&&4===s.readyState&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))&&setTimeout(l)},s.onabort=function(){s&&(n(H("Request aborted",e,"ECONNABORTED",s)),s=null)},s.onerror=function(){n(H("Network Error",e,null,s)),s=null},s.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(H(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",s)),s=null},R.isStandardBrowserEnv()){var h=(e.withCredentials||q(f))&&e.xsrfCookieName?x.read(e.xsrfCookieName):void 0;h&&(o[e.xsrfHeaderName]=h)}"setRequestHeader"in s&&R.forEach(o,(function(e,t){void 0===r&&"content-type"===t.toLowerCase()?delete o[t]:s.setRequestHeader(t,e)})),R.isUndefined(e.withCredentials)||(s.withCredentials=!!e.withCredentials),i&&"json"!==i&&(s.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&s.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){s&&(s.abort(),n(e),s=null)})),r||(r=null),s.send(r)}))},M=k={};function F(){throw new Error("setTimeout has not been defined")}function B(){throw new Error("clearTimeout has not been defined")}function K(e){if(j===setTimeout)return setTimeout(e,0);if((j===F||!j)&&setTimeout)return j=setTimeout,setTimeout(e,0);try{return j(e,0)}catch(He){try{return j.call(null,e,0)}catch(He){return j.call(this,e,0)}}}!function(){try{j="function"==typeof setTimeout?setTimeout:F}catch(He){j=F}try{I="function"==typeof clearTimeout?clearTimeout:B}catch(He){I=B}}();var L,G=[],J=!1,V=-1;function W(){J&&L&&(J=!1,L.length?G=L.concat(G):V=-1,G.length&&Y())}function Y(){if(!J){var e=K(W);J=!0;for(var t=G.length;t;){for(L=G,G=[];++V<t;)L&&L[V].run();V=-1,t=G.length}L=null,J=!1,function(e){if(I===clearTimeout)return clearTimeout(e);if((I===B||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(e);try{I(e)}catch(He){try{return I.call(null,e)}catch(He){return I.call(this,e)}}}(e)}}function z(e,t){this.fun=e,this.array=t}function Q(){}M.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];G.push(new z(e,t)),1!==G.length||J||K(Y)},z.prototype.run=function(){this.fun.apply(null,this.array)},M.title="browser",M.browser=!0,M.env={},M.argv=[],M.version="",M.versions={},M.on=Q,M.addListener=Q,M.once=Q,M.off=Q,M.removeListener=Q,M.removeAllListeners=Q,M.emit=Q,M.prependListener=Q,M.prependOnceListener=Q,M.listeners=function(e){return[]},M.binding=function(e){throw new Error("process.binding is not supported")},M.cwd=function(){return"/"},M.chdir=function(e){throw new Error("process.chdir is not supported")},M.umask=function(){return 0};var X={};(function(e){(function(){"use strict";var t={"Content-Type":"application/x-www-form-urlencoded"};function n(e,t){!R.isUndefined(e)&&R.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var r,o={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==e&&"[object process]"===Object.prototype.toString.call(e))&&(r=D),r),transformRequest:[function(e,t){return P(t,"Accept"),P(t,"Content-Type"),R.isFormData(e)||R.isArrayBuffer(e)||R.isBuffer(e)||R.isStream(e)||R.isFile(e)||R.isBlob(e)?e:R.isArrayBufferView(e)?e.buffer:R.isURLSearchParams(e)?(n(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):R.isObject(e)||t&&"application/json"===t["Content-Type"]?(n(t,"application/json"),function(e,t,n){if(R.isString(e))try{return(0,JSON.parse)(e),R.trim(e)}catch(He){if("SyntaxError"!==He.name)throw He}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||r&&R.isString(e)&&e.length)try{return JSON.parse(e)}catch(He){if(o){if("SyntaxError"===He.name)throw A(He,this,"E_JSON_PARSE");throw He}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};R.forEach(["delete","get","head"],(function(e){o.headers[e]={}})),R.forEach(["post","put","patch"],(function(e){o.headers[e]=R.merge(t)})),X=o}).call(this)}).call(this,k);var Z=function(e,t,n){var r=this||X;return R.forEach(n,(function(n){e=n.call(r,e,t)})),e},$=function(e){return!(!e||!e.__CANCEL__)};function ee(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var te,ne=function(e){return ee(e),e.headers=e.headers||{},e.data=Z.call(e,e.data,e.headers,e.transformRequest),e.headers=R.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),R.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||X.adapter)(e).then((function(t){return ee(e),t.data=Z.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return $(t)||(ee(e),t&&t.response&&(t.response.data=Z.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},re=function(e,t){t=t||{};var n={},r=["url","method","data"],o=["headers","auth","proxy","params"],i=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function a(e,t){return R.isPlainObject(e)&&R.isPlainObject(t)?R.merge(e,t):R.isPlainObject(t)?R.merge({},t):R.isArray(t)?t.slice():t}function u(r){R.isUndefined(t[r])?R.isUndefined(e[r])||(n[r]=a(void 0,e[r])):n[r]=a(e[r],t[r])}R.forEach(r,(function(e){R.isUndefined(t[e])||(n[e]=a(void 0,t[e]))})),R.forEach(o,u),R.forEach(i,(function(r){R.isUndefined(t[r])?R.isUndefined(e[r])||(n[r]=a(void 0,e[r])):n[r]=a(void 0,t[r])})),R.forEach(s,(function(r){r in t?n[r]=a(e[r],t[r]):r in e&&(n[r]=a(void 0,e[r]))}));var c=r.concat(o).concat(i).concat(s),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===c.indexOf(e)}));return R.forEach(d,u),n},oe={version:"0.21.4"},ie={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){ie[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var se={},ae=oe.version.split(".");ie.transitional=function(e,t,n){var r=t&&function(e,t){for(var n=t?t.split("."):ae,r=e.split("."),o=0;o<3;o++){if(n[o]>r[o])return!0;if(n[o]<r[o])return!1}return!1}(t);function o(e,t){return"[Axios v"+oe.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,s){if(!1===e)throw new Error(o(i," has been removed in "+t));return r&&!se[i]&&(se[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,s)}};var ue={},ce=(te={assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),o=r.length;o-- >0;){var i=r[o],s=t[i];if(s){var a=e[i],u=void 0===a||s(a,i,e);if(!0!==u)throw new TypeError("option "+i+" must be "+u)}else if(!0!==n)throw Error("Unknown option "+i)}},validators:ie}).validators;function de(e){this.defaults=e,this.interceptors={request:new C,response:new C}}de.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=re(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&te.assertOptions(t,{silentJSONParsing:ce.transitional(ce.boolean,"1.0.0"),forcedJSONParsing:ce.transitional(ce.boolean,"1.0.0"),clarifyTimeoutError:ce.transitional(ce.boolean,"1.0.0")},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var o,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!r){var s=[ne,void 0];for(Array.prototype.unshift.apply(s,n),s=s.concat(i),o=Promise.resolve(e);s.length;)o=o.then(s.shift(),s.shift());return o}for(var a=e;n.length;){var u=n.shift(),c=n.shift();try{a=u(a)}catch(d){c(d);break}}try{o=ne(a)}catch(d){return Promise.reject(d)}for(;i.length;)o=o.then(i.shift(),i.shift());return o},de.prototype.getUri=function(e){return e=re(this.defaults,e),O(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},R.forEach(["delete","get","head","options"],(function(e){de.prototype[e]=function(t,n){return this.request(re(n||{},{method:e,url:t,data:(n||{}).data}))}})),R.forEach(["post","put","patch"],(function(e){de.prototype[e]=function(t,n,r){return this.request(re(r||{},{method:e,url:t,data:n}))}})),ue=de;var fe={};function le(e){this.message=e}le.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},le.prototype.__CANCEL__=!0,fe=le;var he;function ve(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new fe(e),t(n.reason))}))}ve.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},ve.source=function(){var e;return{token:new ve((function(t){e=t})),cancel:e}},he=ve;var pe={};function me(e){var t=new ue(e),n=_(ue.prototype.request,t);return R.extend(n,ue.prototype,t),R.extend(n,t),n}var _e=me(X);_e.Axios=ue,_e.create=function(e){return me(re(_e.defaults,e))},_e.Cancel=fe,_e.CancelToken=he,_e.isCancel=$,_e.all=function(e){return Promise.all(e)},_e.spread=function(e){return function(t){return e.apply(null,t)}},_e.isAxiosError=function(e){return"object"==typeof e&&!0===e.isAxiosError},(pe=_e).default=_e;var ge=pe,ye={},be=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Ee=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.bindJWTUpdates=ye.stRequest=void 0;ye.stRequest="undefined"!=typeof window&&window.fetch?function(e){return be(this,void 0,void 0,(function(){return Ee(this,(function(t){return e.data&&(e.body=JSON.stringify(e.data)),e.headers["Content-Type"]="application/json",[2,window.fetch(e.url,e).then((function(e){if(e.ok)return e.json();var t=new Error(e.statusText);throw t.response={status:e.status},t}))]}))}))}:function(e,t){return be(this,void 0,void 0,(function(){return Ee(this,(function(n){return e&&e.headers&&(e.decompress=!0),[2,ge.default(e).then((function(e){return e.data})).catch((function(n){if(t)return t(n,e);throw n}))]}))}))},ye.bindJWTUpdates=function(e){return function(t,n){return be(void 0,void 0,void 0,(function(){var r,o;return Ee(this,(function(i){switch(i.label){case 0:return(r=e.getTokenExp())&&r<(new Date).getTime()-20?[4,e.refreshUserToken()]:[3,2];case 1:(o=i.sent())&&(t.headers.Authorization="Bearer "+o),i.label=2;case 2:return[2,ye.stRequest(t,n)]}}))}))}};var Se={};(function(e){(function(){"use strict";var t=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(Se,"__esModule",{value:!0}),Se.RestfulChatEventService=void 0;var i=function(i,a){var u=this;void 0===a&&(a={}),this._config={appId:""},this._apiHeaders={},this._jsonHeaders={},this._fetching=!1,this._eventHandlers={},this._ignoreList=new Set,this.request=ye.bindJWTUpdates(this),this._user={userid:"",handle:""},this.lastCursor=void 0,this.oldestCursor=void 0,this._maxEventsPerUpdateLimit=100,this._maxEventBufferSize=30,this.NetworkRequest=ye.bindJWTUpdates(this),this._pollFrequency=800,this._preRenderedMessages=new Set,this._eventSpacingMs=100,this.setUpdatesCursor=function(e){u.lastCursor=e||""},this.setPreviousEventsCursor=function(e){u.oldestCursor=e||""},this.setEventHandlers=function(e){u._eventHandlers=e},this.getEventHandlers=function(){return u._eventHandlers||{}},this.setUser=function(e){u._config.user=Object.assign(u._user,e),u._user=u._config.user},this.getTokenExp=function(){return u._tokenExp},this.getCurrentUser=function(){return u._user},this.setUserToken=function(e){u._config.userToken=e,u.setConfig(u._config)},this.getUserToken=function(){return t(u,void 0,void 0,(function(){return n(this,(function(e){return[2,this._config.userToken||""]}))}))},this.setUserTokenRefreshFunction=function(e){u._config.userTokenRefreshFunction=e},this.refreshUserToken=function(){return t(u,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:if(!this._config.userToken)throw new Error("You must set a user token before you can refresh it.  Also ensure that you set a refresh function");if(!this._config.userTokenRefreshFunction)throw new Error("You must set a refresh function in order to refresh a userToken. Also ensure that the user token JWT is properly set.");return[4,this._config.userTokenRefreshFunction(this._config.userToken)];case 1:return e=t.sent(),this.setUserToken(e),[2,e]}}))}))},this.setConfig=function(t){u._config=Object.assign({},o.DEFAULT_CONFIG,t),u._user=Object.assign({},u._user,u._config.user),u._apiHeaders=f.getUrlEncodedHeaders(u._config.apiToken,u._config.userToken),u._jsonHeaders=f.getJSONHeaders(u._config.apiToken,u._config.userToken),u._smoothEventUpdates=!(!u._config.smoothEventUpdates&&!u._smoothEventUpdates),u._maxEventBufferSize=u._config.maxEventBufferSize||u._maxEventBufferSize;try{var n=e.env.SPORTSTALK_POLL_FREQUENCY?parseInt(e.env.SPORTSTALK_POLL_FREQUENCY):800;u._pollFrequency=n}catch(He){console.log(He),u._pollFrequency=t.chatEventPollFrequency||800}u._eventSpacingMs=t.updateEmitFrequency||Math.floor(u._pollFrequency/100)},this.setEventSmoothingMs=function(e){e&&"number"==typeof e&&(u._eventSpacingMs=e)},this._getKeepAlive=function(){return u._keepAliveFunction},this._resetKeepAlive=function(e,t){var n={method:o.POST,url:f.buildAPI(u._config,"chat/rooms/"+e+"/sessions/"+t+"/touch"),headers:u._jsonHeaders};u._keepAliveFunction=function(){var e=ye.stRequest(n);return this._eventHandlers.onTouch&&this._eventHandlers.onTouch(e),e},u._endKeepAlive()},this._startKeepAlive=function(e,t){u._resetKeepAlive(e,t),u._keepAliveInterval=setInterval(u._keepAliveFunction,1e3)},this._endKeepAlive=function(){u._keepAliveInterval&&clearInterval(u._keepAliveInterval)},this.getCurrentRoom=function(){return u._currentRoom},this.setCurrentRoom=function(e){var t=u._currentRoom;if(!e||!e.id)throw new s.SettingsError(m.REQUIRE_ROOM_ID);return u._currentRoom&&u._currentRoom.id===e.id?u._currentRoom=e:(u.lastTimestamp=void 0,u.lastCursor=void 0,u.lastMessageId=void 0,u.firstMessageId=void 0,u.firstMessageTime=void 0,u._currentRoom=e,u._eventHandlers.onRoomChange&&u._eventHandlers.onRoomChange(u._currentRoom,t),u._currentRoom?u._roomApi=f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id):u._roomApi=null,u._commandApi=u._roomApi+"/command",u._updatesApi=u._roomApi+"/updates"),e},this.setUpdateSpeed=function(e){u._pollFrequency=e},this.startEventUpdates=function(e){if(u._startKeepAlive(u._currentRoom.id,u._user.userid||"anonymous"),e&&(u._maxEventsPerUpdateLimit=e),u._polling)console.log("ALREADY CONNECTED TO TALK");else{if(!u._updatesApi||!u._currentRoom)throw new s.SettingsError(m.NO_ROOM_SET);if(u._eventHandlers.onChatStart&&u._eventHandlers.onChatStart(),!u._eventHandlers.onChatEvent&&!u._eventHandlers.onNetworkResponse)throw new s.SettingsError(m.NO_HANDLER_SET);if(!u._pollFrequency||isNaN(u._pollFrequency)||u._pollFrequency<250||u._pollFrequency>5e3)throw new s.SettingsError("Invalid poll _pollFrequency.  Must be between 250ms and 5000ms");u._polling=setInterval(u._fetchUpdatesAndTriggerCallbacks,u._pollFrequency||500),u._fetchUpdatesAndTriggerCallbacks()}},this._fetchUpdatesAndTriggerCallbacks=function(){if(u._fetching)return Promise.resolve();var e=u.lastCursor;return u._fetching=!0,u.getUpdates(e,u._maxEventsPerUpdateLimit).then(u.handleUpdates).catch((function(e){u._eventHandlers&&u._eventHandlers.onNetworkError?u._eventHandlers.onNetworkError(e):console.log(e),u._fetching=!1}))},this.stopEventUpdates=function(){u._endKeepAlive(),u._polling&&clearInterval(u._polling)},this.getUpdates=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=100),!u._roomApi)throw new s.SettingsError("No room selected");var n={method:o.GET,url:u._updatesApi+"?limit="+t+"&cursor="+e,headers:u._jsonHeaders};return ye.stRequest(n).then((function(e){return u._eventHandlers&&u._eventHandlers.onNetworkResponse&&u._eventHandlers.onNetworkResponse(e),e.data&&e.data.cursor&&(u.lastCursor=e.data.cursor),e.data}))},this._handleUpdate=function(e){if(!e.shadowban||e.userid===u._user.userid&&u._user){if(e.eventtype==r.EventType.speech){if(u._eventHandlers.onSpeech)return void u._eventHandlers.onSpeech(e);if(u._eventHandlers.onChatEvent)return void u._eventHandlers.onChatEvent(e)}e.eventtype==r.EventType.purge&&u._eventHandlers.onPurgeEvent?u._eventHandlers.onPurgeEvent(e):e.eventtype==r.EventType.reply&&u._eventHandlers.onReply?u._eventHandlers.onReply(e):e.eventtype==r.EventType.bounce&&u._eventHandlers.onBounce?u._eventHandlers.onBounce(e):e.eventtype==r.EventType.reaction&&u._eventHandlers.onReaction?u._eventHandlers.onReaction(e):e.eventtype==r.EventType.replace&&u._eventHandlers.onReplace?u._eventHandlers.onReplace(e):e.eventtype==r.EventType.remove&&u._eventHandlers.onRemove?u._eventHandlers.onRemove(e):e.eventtype==r.EventType.banned&&u._eventHandlers.onBanned?u._eventHandlers.onBanned(e):!u._eventHandlers.onAnnouncement||e.eventtype!=r.EventType.announcement&&e.customtype!=r.EventType.announcement?u._eventHandlers.onChatEvent&&u._eventHandlers.onChatEvent(e):u._eventHandlers.onAnnouncement(e)}},this._spacedUpdate=function(e,t,n,r){var o=r||u._eventSpacingMs;return new Promise((function(r,i){setTimeout((function(){n(e),r(!0)}),t*o)}))},this.handleUpdates=function(e){return t(u,void 0,void 0,(function(){var t,r,o,i,s=this;return n(this,(function(n){switch(n.label){case 0:if(this._fetching=!1,!e)return[2];if(e.cursor&&(this.lastCursor=e.cursor),!(t=e.events)||!t.length)return[3,5];r=0,n.label=1;case 1:return r<t.length?(o=t[r],this._preRenderedMessages.has(o.id)?(this._preRenderedMessages.delete(o.id),[3,4]):(i=o.ts,!this.lastTimestamp||i>this.lastTimestamp?(this.lastTimestamp=i,this.lastMessageId=o.id):(!this.firstMessageTime||i<this.firstMessageTime)&&(this.firstMessageTime=i,this.firstMessageId=o.id),this._ignoreList.has(o.userid)?[3,4]:this._smoothEventUpdates&&t.length<this._maxEventBufferSize?[4,this._spacedUpdate(o,r,this._handleUpdate).catch((function(e){if(s._eventHandlers&&s._eventHandlers.onNetworkError)return s._eventHandlers.onNetworkError(e);console.log(e)}))]:[3,3])):[3,5];case 2:return n.sent(),[3,4];case 3:this._handleUpdate(o),n.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))},this._evaluateCommandResponse=function(e,r){return t(u,void 0,void 0,(function(){var t,o;return n(this,(function(n){switch(n.label){case 0:if(e.startsWith("*")){if(t=this._eventHandlers.onHelp,e.startsWith("*help")&&t&&t instanceof Function)return t(r),[2,r];(o=this._eventHandlers.onAdminCommand)&&o instanceof Function&&o(r)}return r.data.speech&&this._smoothEventUpdates?[4,this.handleUpdates({events:[r.data.speech]})]:[3,2];case 1:n.sent(),this._preRenderedMessages.add(r.data.speech.id),n.label=2;case 2:return[2,r]}}))}))},this.executeChatCommand=function(e,t,n){var r=Object.assign(n||{},{command:t,userid:e.userid}),i={method:o.POST,url:u._commandApi,headers:u._jsonHeaders,data:r},s=u._eventHandlers&&u._eventHandlers.onNetworkError;return ye.stRequest(i,s).then((function(e){return u._evaluateCommandResponse(t,e)})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.sendThreadedReply=function(e,t,n,r){var i=n.id||n,s=Object.assign({body:t,userid:e.userid},r),a={method:o.POST,url:f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id+"/events/"+i+"/reply"),headers:u._jsonHeaders,data:s};return ye.stRequest(a).catch((function(e){throw e}))},this.sendQuotedReply=function(e,t,n,r){var i=n.id||n,s=Object.assign({body:t,userid:e.userid},r),a={method:o.POST,url:f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id+"/events/"+i+"/quote"),headers:u._jsonHeaders,data:s};return ye.stRequest(a).then((function(e){return e})).catch((function(e){throw e}))},this.reportMessage=function(e,t){var n=e.id||e,r={method:o.POST,url:f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id+"/events/"+n+"/report"),headers:u._jsonHeaders,data:t};return ye.stRequest(r).then((function(e){return e})).catch((function(e){throw e}))},this.reactToEvent=function(e,t,n,r){var i=n.id||n,s=Object.assign({command:"",userid:e.userid,reacted:!0,reaction:t},r),a={method:o.POST,url:u._roomApi+"/events/"+i+"/react",headers:u._jsonHeaders,data:s};return ye.stRequest(a).then((function(e){return e.data})).catch((function(e){throw e}))},this.sendAdvertisement=function(e,t){var n=Object.assign({command:t.message||"advertisement",eventtype:r.ChatOptionsEventType.custom,customtype:r.ChatOptionsEventType.ad,userid:e.userid,custompayload:JSON.stringify(t)}),i={method:o.POST,headers:u._jsonHeaders,data:n,url:u._commandApi};return ye.stRequest(i).then((function(e){return e.data}))},this.sendGoal=function(e,t,n,i){var s={img:t,link:""};n&&"string"!=typeof n&&(n="GOAL!");var a=Object.assign({command:n||"GOAL!",eventtype:r.ChatOptionsEventType.custom,customtype:r.CustomEventTypes.goal,userid:e.userid,custompayload:JSON.stringify(Object.assign(s,i))});return ye.stRequest({method:o.POST,url:u._commandApi,headers:u._jsonHeaders,data:a}).then((function(e){return e}))},this.permanetlyDeleteEvent=function(e,t){if(!t)throw new Error("Cannot delete a null or undefined event");e.userid;var n=t.id||t;if(!n)throw new Error("Cannot delete an event without an id");var r={method:o.DELETE,url:f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id+"/events/"+n),headers:u._jsonHeaders};return ye.stRequest(r).then((function(e){return e})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.flagEventLogicallyDeleted=function(e,t,n){if(void 0===n&&(n=!1),!t)throw new Error("Cannot delete a null or undefined event");var r=e.userid||e,i=t.id||t;if(!i)throw new Error("Cannot delete an event without an id");var s={method:o.PUT,headers:u._jsonHeaders,url:f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id+"/events/"+i+"/setdeleted?userid="+r+"&deleted=true&permanentifnoreplies="+n)};return ye.stRequest(s).then((function(e){return e})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message+", config:"+JSON.stringify(s))}))},this.listPreviousEvents=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=100),!u._roomApi)throw new s.SettingsError("No room selected");var n=e||u.oldestCursor||"";return ye.stRequest({method:o.GET,url:u._roomApi+"/listpreviousevents?cursor="+(n||"")+"&limit="+(t||100),headers:u._jsonHeaders}).then((function(t){return e||(u.oldestCursor=t.data?t.data.cursor:u.oldestCursor),t.data}))},this.listEventsHistory=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=100),!u._roomApi)throw new s.SettingsError("No room selected");return ye.stRequest({method:o.GET,url:u._roomApi+"/listeventshistory?cursor="+(e||"")+"&limit="+(t||100),headers:u._jsonHeaders}).then((function(e){return e.data}))},this.searchEventHistory=function(e){if(e.fromhandle&&e.fromuserid)throw new s.SettingsError("Search for ID or Handle, not both");var t={method:o.POST,url:f.buildAPI(u._config,"chat/searchevents"),headers:u._jsonHeaders,data:e};return ye.stRequest(t).then((function(e){return e.data}))},this.listEventsByType=function(e){return ye.stRequest({method:o.GET,url:u._roomApi+"/listeventsbytype?eventtype="+e,headers:u._jsonHeaders}).then((function(e){return e.data}))},this.updateChatEvent=function(e,t,n){var r=n?n.userid||n:u._user.userid,i=f.forceObjKeyOrString(e,"id");if(!r)throw new Error("Require a valid userid to update a Chat Event.");var s={method:o.PUT,url:f.buildAPI(u._config,"chat/rooms/"+u._currentRoom.id+"/events/"+i),headers:u._jsonHeaders,data:{userid:r,body:t}};return ye.stRequest(s).then((function(e){return e.data}))},this.listEventsByTimestamp=function(e){if(!e||!e.ts)throw new Error("Must provide a timestamp value to list events");var t={method:o.GET,url:f.buildAPI(u._config,"/chat/rooms/"+u._currentRoom.id+"}/eventsbytimestamp/list/"+e.ts+"?limitolder="+(e.limitolder?e.limitolder:0)+"&limitnewer="+(e.limitnewer?e.limitnewer:0)),headers:u._jsonHeaders};return ye.stRequest(t).then((function(e){return e.data}))},this.setConfig(i),this.setEventHandlers(a)};Se.RestfulChatEventService=i}).call(this)}).call(this,k);var Te,Re,we={};Object.defineProperty(we,"__esModule",{value:!0}),we.ReportType=we.ModerationType=void 0,(Re=we.ModerationType||(we.ModerationType={})).pre="pre",Re.post="post",(Te=we.ReportType||(we.ReportType={})).abuse="abuse",Te.spam="spam";var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.RestfulChatRoomService=void 0;var Ce=function(){function e(e){var t=this;this._apiHeaders={},this._jsonHeaders={},this._apiExt="chat/rooms",this.setConfig=function(e){t._config=e,t._apiHeaders=f.getUrlEncodedHeaders(t._config.apiToken,t._config.userToken),t._jsonHeaders=f.getJSONHeaders(t._config.apiToken,t._config.userToken)},this.listRooms=function(e,n){var r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"?cursor="+(e||"")+"&limit="+(n||100)),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data}))},this.deleteRoom=function(e){var n=f.forceObjKeyOrString(e),r={method:o.DELETE,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data}))},this.createRoom=function(e){var n={method:o.POST,url:f.buildAPI(t._config,t._apiExt),headers:t._jsonHeaders,data:e};return ye.stRequest(n).then((function(e){return e.data}))},this.listUserMessages=function(e,n,r,i){void 0===r&&(r=""),void 0===i&&(i=100);var s=f.forceObjKeyOrString(n),a=f.forceObjKeyOrString(e,"userid"),u=f.buildAPI(t._config,t._apiExt+"/"+s+"/messagesbyuser/"+a+"/?limit="+(i||100)+"&cursor="+(r||""));return ye.stRequest({method:o.GET,url:u,headers:t._jsonHeaders}).then((function(e){return e.data}))},this.listParticipants=function(e,n,r){void 0===r&&(r=200);var i={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+e.id+"/participants?cursor="+(n||"")+"&maxresults="+(r||200)),headers:t._jsonHeaders};return ye.stRequest(i).then((function(e){return e.data}))},this.joinRoom=function(e,n){var r=f.forceObjKeyOrString(e),i={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+r+"/join"),headers:t._jsonHeaders};return n&&n.userid&&(i.data={userId:n.userid,handle:n.handle,displayname:n.displayname||"",pictureurl:n.pictureurl||"",profileurl:n.profileurl||""}),ye.stRequest(i).then((function(e){return e.data})).catch((function(e){throw new Error(e)}))},this.getEventById=function(e,n){if(!n)throw new s.SettingsError("Cannot retrieve event: No room selected");if(!e)throw new s.SettingsError("Cannot retrieve event: Invalid event ID");var r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+n+"/events/"+e),headers:t._apiHeaders};return ye.stRequest(r).then((function(e){return e.data}))},this.exitRoom=function(e,n){var r=f.forceObjKeyOrString(n),i=f.forceObjKeyOrString(e,"userid"),s={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+r+"/exit"),headers:t._jsonHeaders,data:{userid:i}};return ye.stRequest(s).then((function(e){return e.message}))},this.closeRoom=function(e){var n=f.forceObjKeyOrString(e),r={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders,data:{roomisopen:!1}};return ye.stRequest(r).then((function(e){return e.message}))},this.openRoom=function(e){var n=f.forceObjKeyOrString(e),r={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders,data:{roomisopen:!0}};return ye.stRequest(r).then((function(e){return e.message}))},this.updateRoom=function(e){var n=f.forceObjKeyOrString(e),r={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders,data:e};return ye.stRequest(r).then((function(e){return e.message}))},this.getRoomDetails=function(e){var n=f.forceObjKeyOrString(e),r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data}))},this.getRoomDetailsByCustomId=function(e){var n=f.forceObjKeyOrString(e,"customid"),r={method:o.GET,url:f.buildAPI(t._config,"chat/roomsbycustomid/"+n),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data}))},this.purgeUserMessagesFromRoom=function(e,n){var r=f.forceObjKeyOrString(e,"id"),i=f.forceObjKeyOrString(n,"userid"),s={method:o.POST,url:f.buildAPI(t._config,"chat/rooms/"+r+"/commands/purge/"+i),headers:t._jsonHeaders};return ye.stRequest(s)},this.bounceUserFromRoom=function(e,n,r){var i=f.forceObjKeyOrString(e,"id"),s=f.forceObjKeyOrString(n,"userid"),a=r||"The bouncer shows "+(n.handle||s)+" the way out.",u={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+i+"/bounce"),headers:t._jsonHeaders,data:{userid:s,bounce:"true",announcement:a}};return ye.stRequest(u)},this.unbounceUserFromRoom=function(e,n,r){var i=f.forceObjKeyOrString(e),s=f.forceObjKeyOrString(n,"userid"),a={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+i+"/bounce"),headers:t._jsonHeaders,data:{userid:s,bounce:"false",announcement:r||"The bouncer let "+s+" back in."}};return ye.stRequest(a)},this.getRoomExtendedDetails=function(e){var n=e.roomids,r=e.entities,i=e.customids,s=f.queryStringify({roomid:n,entity:r,customid:i}),a={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/batch/details?"+s),headers:t._jsonHeaders};return ye.stRequest(a).then((function(e){return e.data}))},this.setRoomShadowbanStatus=function(e,n,r,i){var s=f.forceObjKeyOrString(n),a={shadowban:!!r,applyeffect:!!r,userid:f.forceObjKeyOrString(e,"userid")};i&&a.applyeffect&&(a.expireseconds=i);var u={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+s+"/shadowban"),headers:t._jsonHeaders,data:a};return ye.stRequest(u).then((function(e){return e.data}))},this.setRoomMuteStatus=function(e,n,r,i){var s=f.forceObjKeyOrString(n),a={applyeffect:!!r,mute:!!r,userid:f.forceObjKeyOrString(e,"userid")};i&&a.applyeffect&&(a.expireseconds=i);var u={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+s+"/mute"),headers:t._jsonHeaders,data:a};return ye.stRequest(u).then((function(e){return e.data}))},this.reportUser=function(e,n,r,i){void 0===r&&(r=we.ReportType.abuse);var s=f.forceObjKeyOrString(e,"userid"),a=f.forceObjKeyOrString(n,"userid"),u=f.forceObjKeyOrString(i,"id"),c={method:o.POST,url:f.buildAPI(t._config,"/chat/rooms/"+u+"/users/"+s+"/report"),headers:t._jsonHeaders,data:{userid:a,reporttype:r}};return ye.stRequest(c).then((function(e){return e.data}))},this.setConfig(e)}return e.prototype.joinRoomByCustomId=function(e,t){var n=f.forceObjKeyOrString(e,"customid"),r={method:o.POST,url:f.buildAPI(this._config,"chat/roomsbycustomid/"+n+"/join"),headers:this._jsonHeaders};return t&&(r.data={userId:t.userid,handle:t.handle,displayname:t.displayname||"",pictureurl:t.pictureurl||"",profileurl:t.profileurl||""}),ye.stRequest(r).then((function(e){return e.data}))},e}();Oe.RestfulChatRoomService=Ce;var Ue,ke,je={};Object.defineProperty(je,"__esModule",{value:!0}),je.UserSearchType=je.UserRole=void 0,(ke=je.UserRole||(je.UserRole={})).admin="admin",ke.moderator="moderator",ke.user="user",(Ue=je.UserSearchType||(je.UserSearchType={})).handle="handle",Ue.name="name",Ue.userid="userid";var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.RestfulUserService=void 0;var Pe=function(e){var t=this;this._apiExt="user/users",this.setConfig=function(e){t._config=e,t._jsonHeaders=f.getJSONHeaders(t._config.apiToken,t._config.userToken)},this.setUserToken=function(e){t._config.userToken=e,t.setConfig(t._config)},this.setUserTokenRefreshFunction=function(e){t._config.userTokenRefreshFunction=e,t.setConfig(t._config)},this.createOrUpdateUser=function(e){var n={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+e.userid),headers:t._jsonHeaders,data:{userid:e.userid,handle:e.handle,displayname:e.displayname,pictureurl:e.pictureurl,profileurl:e.profileurl,role:e.role||je.UserRole.user}};return ye.stRequest(n).then((function(e){return e.data}))},this.setBanStatus=function(e,n,r){var i=e.userid||e,s=f.buildAPI(t._config,t._apiExt+"/"+i+"/ban"),a={applyeffect:""+n};r&&n&&(a.expireseconds=Math.floor(r));var u={method:o.POST,url:s,headers:t._jsonHeaders,data:a};return ye.stRequest(u).then((function(e){return e.data}))},this.setShadowBanStatus=function(e,n,r){var i=e.userid||e,s=f.buildAPI(t._config,t._apiExt+"/"+i+"/shadowban"),a={shadowban:""+n,applyeffect:""+n};r&&n&&(a.expireseconds=Math.floor(r));var u={method:o.POST,url:s,headers:t._jsonHeaders,data:a};return ye.stRequest(u).then((function(e){return e.data}))},this.searchUsers=function(e,n){var r=f.buildAPI(t._config,"user/search"),i={type:n};n&&n!==je.UserSearchType.handle||(i.handle=e),n===je.UserSearchType.userid&&(i.userid=e),n===je.UserSearchType.name&&(i.name=e);var s={method:o.POST,url:r,headers:t._jsonHeaders,data:i};return ye.stRequest(s).then((function(e){return e.data}))},this.deleteUser=function(e){var n=e.userid||e,r={method:o.DELETE,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.listUsers=function(e){var n="?";e&&(n+=f.formify(e));var r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.getUserDetails=function(e){var n=f.forceObjKeyOrString(e,"userid"),r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.reportUser=function(e,n,r){void 0===r&&(r=we.ReportType.abuse);var i=f.forceObjKeyOrString(e,"userid"),s={userid:f.forceObjKeyOrString(n,"userid"),reporttype:r},a={method:o.POST,url:f.buildAPI(t._config,"user/users/"+i+"/report"),headers:t._jsonHeaders,data:s};return ye.stRequest(a).then((function(e){return e.data})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.listUserSubscribedRooms=function(e,n){var r=f.forceObjKeyOrString(e,"userid"),i=f.formify({cursor:n||""}),s={method:o.GET,url:f.buildAPI(t._config,"chat/user/"+r+"/subscriptions?"+i),headers:t._jsonHeaders};return ye.stRequest(s).then((function(e){return e.data})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.listUsersInModerationQueue=function(e){var n={method:o.POST,url:f.buildAPI(t._config,"user/moderation/queues/reportedusers"),headers:t._jsonHeaders,data:e};return ye.stRequest(n).then((function(e){return e.data})).catch((function(e){throw new Error(e.response.status+" "+(e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText)+" - "+e.message)}))},this.setConfig(e)};Ie.RestfulUserService=Pe;var Ae={};function He(e){this.message=e}He.prototype=new Error,He.prototype.name="InvalidCharacterError";var xe="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new He("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,o=0,i=0,s="";r=t.charAt(i++);~r&&(n=o%4?64*n+r:r,o++%4)?s+=String.fromCharCode(255&n>>(-2*o&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return s};function Ne(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(xe(t).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}catch(e){return xe(t)}}function qe(e){this.message=e}function De(e,t){if("string"!=typeof e)throw new qe("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(Ne(e.split(".")[n]))}catch(e){throw new qe("Invalid token specified: "+e.message)}}qe.prototype=new Error,qe.prototype.name="InvalidTokenError";const Me=De;Me.default=De,Me.InvalidTokenError=qe,Ae=Me;var Fe={},Be=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Ke=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.RestfulNotificationService=void 0;var Le=function(){function e(e){var t=this;this._jsonHeaders={},this.getCurrentUser=function(){return t._user},this.setUserToken=function(e){var n=Ae.default(e);n.exp?t._tokenExpiry=n.exp:t._tokenExpiry=void 0,t._config.userToken=e,t.setConfig(t._config)},this.getUserToken=function(){return Be(t,void 0,void 0,(function(){return Ke(this,(function(e){return[2,this._config.userToken||""]}))}))},this.refreshUserToken=function(){return Be(t,void 0,void 0,(function(){var e;return Ke(this,(function(t){switch(t.label){case 0:if(!this._config.userToken)throw new Error("You must set a user token before you can refresh it.  Also ensure that you set a refresh function");if(!this._config.userTokenRefreshFunction)throw new Error("You must set a refresh function in order to refresh a userToken. Also ensure that the user token JWT is properly set.");return[4,this._config.userTokenRefreshFunction(this._config.userToken)];case 1:return e=t.sent(),this.setUserToken(e),[2,e]}}))}))},this.setConfig=function(e){t._config=e,t._jsonHeaders=f.getJSONHeaders(t._config.apiToken,t._config.userToken)},this.setUserTokenRefreshFunction=function(e){t._config.userTokenRefreshFunction=e,t.setConfig(t._config)},this.listUserNotifications=function(e){var n={limit:20,includeread:!1,filterNotificationTypes:[r.EventType.speech,r.EventType.reply,r.EventType.reaction]},i=Object.assign(n,e);if(!i.userid)throw new s.SettingsError("Must include userid to request notifications");if(!i.filterNotificationTypes||!i.filterNotificationTypes.length)throw new s.SettingsError("Must include at least one notification type");var a="";i.filterNotificationTypes.map((function(e){a=a+"&filterNotificationTypes="+e}));var u={method:o.GET,headers:t._jsonHeaders,url:f.buildAPI(t._config,"user/users/"+i.userid+"/notification/listnotifications?"+a+"&limit="+i.limit+"&includeread="+i.includeread)};return ye.stRequest(u).then((function(e){return e.data}))},this.setNotificationReadStatus=function(e,n,r){void 0===r&&(r=!0);var i={notificationid:e,userid:n,read:!!r};if(!i.notificationid)throw new Error("Must set notification ID to update notificaiton");var s=f.formify(i),a=f.buildAPI(t._config,"/user/users/"+i.userid+"/notification/notifications/"+i.notificationid+"/update?"+s),u={method:o.PUT,headers:t._jsonHeaders,url:a};return ye.stRequest(u).then((function(e){return e.data}))},this._validateNotificationRequest=function(e){if(!e.userid)throw new Error("Must specify userid to set notification status");if(!e.notificationid&&!e.eventid)throw Error("Must set either notificationid or eventid to delete a notification");if(e.notificationid&&e.eventid)throw Error("Set either notificationid or eventid, not both")},this.setNotificationReadStatusByChatEventId=function(e,n,r){void 0===r&&(r=!0);var i={chateventid:e,userid:n,read:!!r};t._validateNotificationRequest(i);var s,a=f.formify(i);if(!i.chateventid)throw new Error("Must include chateventid to set read status");s=f.buildAPI(t._config,"/user/users/"+i.userid+"/notification/notifications/"+i.chateventid+"/update?"+a);var u={method:o.PUT,headers:t._jsonHeaders,url:s};return ye.stRequest(u).then((function(e){return e.data}))},this.markAllNotificationsAsRead=function(e,n){void 0===n&&(n=!0);var r=f.forceObjKeyOrString(e,"userid"),i={method:o.PUT,headers:t._jsonHeaders,url:f.buildAPI(t._config,"/user/users/"+r+"/notification/notifications_all/markread?delete="+n)};return ye.stRequest(i).then((function(e){return e.data}))},this.deleteNotification=function(e,n){return Be(t,void 0,void 0,(function(){var t,r;return Ke(this,(function(i){return t=f.buildAPI(this._config,"/user/users/"+n+"/notification/notifications/"+e),r={method:o.DELETE,headers:this._jsonHeaders,url:t},[2,ye.stRequest(r).then((function(e){return e.data}))]}))}))},this.deleteNotificationByChatEventId=function(e,n){return Be(t,void 0,void 0,(function(){var t,r;return Ke(this,(function(i){return t=f.buildAPI(this._config,"/user/users/"+n+"/notifications/notificationsbyid/chateventid/"+e),r={method:o.DELETE,headers:this._jsonHeaders,url:t},[2,ye.stRequest(r).then((function(e){return e.data}))]}))}))},this.setConfig(e)}return e.prototype.getTokenExp=function(){return this._tokenExpiry},e.prototype.setUser=function(e){this._user=e},e}();Fe.RestfulNotificationService=Le;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.RestfulChatModerationService=void 0;var Je=function(){function e(e){var t=this;this._config={appId:""},this._apiExt="chat/moderation/queues/events",this._handleRefresh=function(){},this.listMessagesInModerationQueue=function(e){if(void 0===e&&(e={}),!e)throw new Error("Must submit valid list request");var n={method:"GET",url:f.buildAPI(t._config,t._apiExt+"?cursor="+(e.cursor?e.cursor:"")+"&roomId="+(e.roomId?e.roomId:"")+"&limit="+(e.limit?e.limit:"")),headers:t._jsonHeaders};return ye.stRequest(n,t._refreshFn).then((function(e){return e.data}))},this.moderateEvent=function(e,n){var r={method:"POST",url:f.buildAPI(t._config,t._apiExt+"/"+e.id+"/applydecision"),headers:t._jsonHeaders,data:{approve:!!n+""}};return ye.stRequest(r).then((function(e){return e.data}))},this.listRoomEffects=function(e){var n=f.forceObjKeyOrString(e),r={method:o.GET,url:f.buildAPI(t._config,"chat/rooms/"+n+"/usereffects"),headers:t._jsonHeaders};return ye.stRequest(r).then((function(e){return e.data}))},this.applyFlagModerationDecision=function(e,n,r){var i=f.forceObjKeyOrString(n),s=f.forceObjKeyOrString(e,"userid"),a={method:o.POST,url:f.buildAPI(t._config,"chat/rooms/"+i+"/moderation/flaggedusers/"+s+"/applydecision"),headers:t._jsonHeaders,data:{approve:!!r+""}};return ye.stRequest(a).then((function(e){return e.data}))},this.muteUserInRoom=function(e,n,r){var i=f.forceObjKeyOrString(n),s={userid:f.forceObjKeyOrString(e,"userid"),mute:!0,applyeffect:!0};r&&(s.expireseconds=r);var a={method:o.POST,url:f.buildAPI(t._config,"chat/rooms/"+i+"/mute"),headers:t._jsonHeaders,data:s};return ye.stRequest(a).then((function(e){return e.data}))},this.unMuteUserInRoom=function(e,n){var r=f.forceObjKeyOrString(n),i={userid:f.forceObjKeyOrString(e,"userid"),mute:!1,applyeffect:!1},s={method:o.POST,url:f.buildAPI(t._config,"chat/rooms/"+r+"/mute"),headers:t._jsonHeaders,data:i};return ye.stRequest(s).then((function(e){return e.data}))},this.shadowbanUserInRoom=function(e,n,r){var i=f.forceObjKeyOrString(n),s={shadowban:!0,applyeffect:!0,userid:f.forceObjKeyOrString(e,"userid")};r&&s.applyeffect&&(s.expireseconds=r);var a={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+i+"/shadowban"),headers:t._jsonHeaders,data:s};return ye.stRequest(a).then((function(e){return e.data}))},this.unShadowbanUserInRoom=function(e,n){var r=f.forceObjKeyOrString(n),i={shadowban:!1,applyeffect:!1,userid:f.forceObjKeyOrString(e,"userid")},s={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+r+"/shadowban"),headers:t._jsonHeaders,data:i};return ye.stRequest(s).then((function(e){return e.data}))},this.purgeMessagesInRoom=function(e,n){var r=f.forceObjKeyOrString(n),i=f.forceObjKeyOrString(e,"userid"),s={method:o.POST,url:f.buildAPI(t._config,"chat/rooms/"+r+"/commands/purge/"+i),headers:t._jsonHeaders};return ye.stRequest(s).then((function(e){return e.data}))},this.setConfig(e)}return e.prototype.setConfig=function(e){this._config=Object.assign({},o.DEFAULT_CONFIG,e),this._refreshFn=e.userTokenRefreshFunction,this._jsonHeaders=f.getJSONHeaders(this._config.apiToken,this._config.userToken)},e}();Ge.RestfulChatModerationService=Je;var Ve={},We=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Ye=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.ChatClient=void 0;var ze=function(){function e(){var e=this;this._config={appId:""},this._user={userid:"",handle:""},this._lastCommand=null,this._lastCommandTime=0,this._lastCommandTimeoutDuration=3e3,this._getDebug=function(){return JSON.stringify(e)},this.setUserTokenRefreshFunction=function(t){e._callBackDelegate?e._callBackDelegate.setCallback(t):e._callBackDelegate=new f.CallBackDelegate(e,t),e._config.userTokenRefreshFunction=e._callBackDelegate.callback,e.setConfig(e._config)},this.setUserToken=function(t){e._config.userToken=t,e.setConfig(e._config)},this.getUserToken=function(){return We(e,void 0,void 0,(function(){return Ye(this,(function(e){return[2,this._config.userToken||""]}))}))},this.refreshUserToken=function(){return We(e,void 0,void 0,(function(){var e;return Ye(this,(function(t){switch(t.label){case 0:if(!this._config.userToken)throw new Error("You must set a user token before you can refresh it.  Also ensure that you set a refresh function");if(!this._config.userTokenRefreshFunction)throw new Error("You must set a refresh function in order to refresh a userToken. Also ensure that the user token JWT is properly set.");return[4,this._config.userTokenRefreshFunction(this._config.userToken)];case 1:return e=t.sent(),this.setUserToken(e),[2,e]}}))}))},this.setConfig=function(t){var n=Object.assign({},o.DEFAULT_CONFIG,t);e._config=n,e._config.userTokenRefreshFunction&&(e._callBackDelegate?e._config.userTokenRefreshFunction!=e._config.userTokenRefreshFunction&&e._callBackDelegate.setCallback(e._config.userTokenRefreshFunction):e._callBackDelegate=new f.CallBackDelegate(e,e._config.userTokenRefreshFunction),e._config.userTokenRefreshFunction=e._callBackDelegate.callback),e._eventService&&e._eventService.setConfig(e._config),e._roomService&&e._roomService.setConfig(e._config),e._userService&&e._userService.setConfig(e._config),e._notificationServce&&e._notificationServce.setConfig(e._config),e._moderationService&&e._moderationService.setConfig(e._config),e._eventService=e._eventService||new Se.RestfulChatEventService(e._config),e._roomService=e._roomService||new Oe.RestfulChatRoomService(e._config),e._userService=e._userService||new Ie.RestfulUserService(e._config),e._notificationServce=e._notificationServce||new Fe.RestfulNotificationService(e._config),e._moderationService=e._moderationService||new Ge.RestfulChatModerationService(e._config),e._config.user&&Object.assign(e._user,e._config.user)},this.getConfig=function(){return e._config},this.getEventById=function(t,n){return e._roomService.getEventById(t,n||e._currentRoom.id)},this.setDefaultGoalImage=function(t){return e._defaultGoalImage=t,e._defaultGoalImage},this.setEventHandlers=function(t){e._eventService.setEventHandlers(t)},this.getEventHandlers=function(){return e._eventService.getEventHandlers()},this.getEventService=function(){return e._eventService},this.getRoomService=function(){return e._roomService},this.startListeningToEventUpdates=function(t){if(t)return e.joinRoom(t).then((function(){return e.startListeningToEventUpdates()}));e._eventService.startEventUpdates()},this.stopListeningToEventUpdates=function(){e._eventService.stopEventUpdates()},this.listRooms=function(t,n){return e._roomService.listRooms(t,n)},this.listParticipants=function(t,n){if(void 0===n&&(n=200),!e._currentRoom)throw new s.SettingsError(m.MISSING_ROOM);return e._roomService.listParticipants(e._currentRoom,t,n)},this.listUserSubscribedRooms=function(t,n){return e._userService.listUserSubscribedRooms(t,n)},this.setUser=function(t){return e._user=t,e._eventService.setUser(e._user),e},this.getCurrentUser=function(t){return e._user},this.createOrUpdateUser=function(t,n){return void 0===n&&(n=!0),e._userService.createOrUpdateUser(t).then((function(t){return n&&(e._user=t),t}))},this.getUpdates=function(){return e._eventService.getUpdates()},this.joinRoom=function(t,n){return void 0===n&&(n=!1),e._roomService.joinRoom(t,e._user).then((function(t){return We(e,void 0,void 0,(function(){return Ye(this,(function(e){switch(e.label){case 0:return this._currentRoom=t.room,this._eventService.setCurrentRoom(this._currentRoom),this._eventService.setPreviousEventsCursor(t.previouseventscursor||""),t.eventscursor.events.reverse(),n?[3,2]:[4,this._eventService.handleUpdates(t.eventscursor)];case 1:e.sent(),e.label=2;case 2:return[2,t]}}))}))}))},this.exitRoom=function(){if(!e._eventService.getCurrentRoom())throw new s.SettingsError("Cannot exit if not in a room!");return e._roomService.exitRoom(e._user,e._currentRoom).then((function(e){return e}))},this.purgeUserMessagesFromRoom=function(t,n){var r=t||e._user,o=n||e._currentRoom;if(!o)throw new s.SettingsError("Requires setting a room to issue purge");return e._roomService.purgeUserMessagesFromRoom(o,r)},this.getCurrentRoom=function(){return e._eventService.getCurrentRoom()},this.setCurrentRoom=function(t){e._currentRoom=t,e._eventService.setCurrentRoom(t)},this.getRoomDetails=function(t){return e._roomService.getRoomDetails(t)},this.getRoomDetailsByCustomId=function(t){return e._roomService.getRoomDetailsByCustomId(t)},this.isUserBouncedFromRoom=function(t,n,r){return We(e,void 0,void 0,(function(){var e,o;return Ye(this,(function(i){switch(i.label){case 0:if(!(e=r||this._currentRoom||null))throw new Error("Invalid room, make sure the room has a valid ID");if(!t)throw new Error("Must provide a user or userid");return o=t.userid||t,!n&&e.id?[3,2]:[4,this.getRoomDetails(e)];case 1:(e=i.sent())&&this._currentRoom&&this._currentRoom.id&&e.id===this._currentRoom.id&&(this._currentRoom=e),i.label=2;case 2:return e&&e.bouncedusers&&0!==e.bouncedusers.length&&e&&e.bouncedusers&&e.bouncedusers.includes(o)?[2,!0]:[2,!1]}}))}))},this.getUserService=function(){return e._userService},this.getUserEffects=function(t,n,r){return We(e,void 0,void 0,(function(){var e,n,o;return Ye(this,(function(i){if(e=r||this._currentRoom||null,n=t||this._user,!e)throw new Error("Need to specify or join a chat room to check user effects");if(!n)throw new Error("Need to specify a user or set current user to get effects");return o=f.forceObjKeyOrString(n,"userid"),[2,this._moderationService.listRoomEffects(e).then((function(e){var t,n={mute:!1,shadowban:!1,flag:!1};return null===(t=null==e?void 0:e.effects)||void 0===t||t.map((function(e){if(e.user.userid==o){if("flag"===e.effect.effecttype)return void(n.flag=!0);if("mute"===e.effect.effecttype)return void(n.mute=!0);if("shadowban"===e.effect.effecttype)return void(n.shadowban=!0)}})),n}))]}))}))},this.isUserShadowbanned=function(t,n,r){return We(e,void 0,void 0,(function(){var e,o;return Ye(this,(function(i){switch(i.label){case 0:if(!(e=r||this._currentRoom||null))throw new Error("Invalid room, make sure the room has a valid ID");if(!t)throw new Error("Must provide a user or userid");return o=t.userid||t,!n&&e.id?[3,2]:[4,this.getRoomDetails(e)];case 1:(e=i.sent())&&this._currentRoom&&this._currentRoom.id&&e.id===this._currentRoom.id&&(this._currentRoom=e),i.label=2;case 2:return e&&e.shadowbannedusers&&0!==e.shadowbannedusers.length&&e&&e.shadowbannedusers&&e.shadowbannedusers.includes(o)?[2,!0]:[2,!1]}}))}))},this.executeChatCommand=function(t,n){return e._throttle(t),e._eventService.executeChatCommand(e._user,t,n)},this.sendAnnouncement=function(t,n){return e._throttle(t),e._eventService.executeChatCommand(e._user,t,Object.assign(n||{},{eventtype:r.ChatOptionsEventType.announcement}))},this.sendQuotedReply=function(t,n,r){return e._throttle(t),e._eventService.sendQuotedReply(e._user,t,n,r)},this.sendThreadedReply=function(t,n,r){return e._throttle(t),e._eventService.sendThreadedReply(e._user,t,n,r)},this.reactToEvent=function(t,n,r){return e._eventService.reactToEvent(e._user,t,n,r)},this.sendAdvertisement=function(t){return e._eventService.sendAdvertisement(e._user,t)},this.sendGoal=function(t,n,r){return e._eventService.sendGoal(e._user,n||e._defaultGoalImage||"",t,r)},this.flagEventLogicallyDeleted=function(t,n){return void 0===n&&(n=!0),e._eventService.flagEventLogicallyDeleted(e._user,t,n)},this.permanetlyDeleteEvent=function(t){return e._eventService.permanetlyDeleteEvent(e._user,t)},this.reportMessage=function(t,n){var r={reporttype:n,userid:e._user.userid};return e._eventService.reportMessage(t,r)},this.createRoom=function(t){return e._roomService.createRoom(t)},this.updateRoom=function(t){return e._roomService.updateRoom(t)},this.deleteRoom=function(t){return e._roomService.deleteRoom(t)},this.setBanStatus=function(t,n){return e._userService.setBanStatus(t,n)},this.setShadowBanStatus=function(t,n){return n&&n.roomid?e._roomService.setRoomShadowbanStatus(t,n.roomid||e._currentRoom,n.applyeffect,n.expireseconds):e._userService.setShadowBanStatus(t,n.applyeffect,n.expireseconds)},this.shadowBanUserFromRoom=function(t,n,r){return e._roomService.setRoomShadowbanStatus(t,r||e._currentRoom,!0,n)},this.unShadowBanUserFromRoom=function(t,n,r){return e._roomService.setRoomShadowbanStatus(t,r||e._currentRoom,!1,n)},this.muteUserInRoom=function(t,n,r,o){var i=o||e._currentRoom;return e._roomService.setRoomMuteStatus(t,i,n,r)},this.searchUsers=function(t,n,r){return e._userService.searchUsers(t,n,r)},this.listUsers=function(t){return e._userService.listUsers(t)},this.listEventsByType=function(t){return e._eventService.listEventsByType(t)},this.listUserNotifications=function(t){void 0===t&&(t={});var n=Object.assign({limit:50,userid:e._user?e._user.userid:"",includeread:!1},t);return e._notificationServce.listUserNotifications(n)},this.markAllNotificationsAsRead=function(t,n){void 0===n&&(n=!0);var r=t||e._user;return e._notificationServce.markAllNotificationsAsRead(r,n)},this.setNotificationReadStatus=function(t,n,r){var o=r||e._user?e._user.userid:"";return e._notificationServce.setNotificationReadStatus(t,o,n)},this.deleteNotification=function(t,n){return We(e,void 0,void 0,(function(){var e;return Ye(this,(function(r){return e=n||this._user?this._user.userid:"",[2,this._notificationServce.deleteNotification(t,e)]}))}))},this.deleteNotificationByChatEventId=function(t,n){var r=n||e._user?e._user.userid:"";return e._notificationServce.deleteNotificationByChatEventId(t,r)},this.deleteUser=function(t){return e._userService.deleteUser(t)},this.getUserDetails=function(t){return e._userService.getUserDetails(t)},this.messageIsReported=function(t,n){var r=n||e._user,o=f.forceObjKeyOrString(r,"userid");return!o&&!!(t&&t.reports&&t.reports.length)&&!!t.reports.find((function(e){return e.userid==o}))},this.getRoomExtendedDetails=function(t){return e._roomService.getRoomExtendedDetails(t)},this.messageIsReactedTo=function(t,n){if(!e._user||!e._user.userid)return!1;if(t&&t.reactions&&t.reactions.length){var r=t.reactions.find((function(e){return e.type===n}));if(void 0!==r)return!!r.users.find((function(t){return t.userid===e._user.userid}))}return!1},this.listPreviousEvents=function(t,n){return void 0===n&&(n=100),e._eventService.listPreviousEvents(t,n)},this.bounceUser=function(t,n){return We(e,void 0,void 0,(function(){return Ye(this,(function(e){switch(e.label){case 0:return[4,this._roomService.bounceUserFromRoom(this._currentRoom,t,n)];case 1:return[2,e.sent().data]}}))}))},this.unbounceUser=function(t,n){return We(e,void 0,void 0,(function(){return Ye(this,(function(e){switch(e.label){case 0:return[4,this._roomService.unbounceUserFromRoom(this._currentRoom,t,n)];case 1:return[2,e.sent().data]}}))}))},this.setUpdatesCursor=function(t){e._eventService.setUpdatesCursor(t)},this.setPreviousEventsCursor=function(t){e._eventService.setPreviousEventsCursor(t)},this.reportUser=function(t,n,r){return void 0===r&&(r=we.ReportType.abuse),e._userService.reportUser(t,n,r)},this.reportUserInRoom=function(t,n,r,o){return void 0===r&&(r=we.ReportType.abuse),e._roomService.reportUser(t,n,r,o)},this.updateChatEvent=function(t,n,r){return e._eventService.updateChatEvent(t,n,r)},this.listEventsByTimestamp=function(t){return e._eventService.listEventsByTimestamp(t)}}return e.prototype._throttle=function(e){if(e==this._lastCommand&&(new Date).getTime()-this._lastCommandTime<this._lastCommandTimeoutDuration){var t=new Error(m.THROTTLE_ERROR);throw t.code=405,t}this._lastCommandTime=(new Date).getTime(),this._lastCommand=e},e.prototype.getTokenExp=function(){return 0},e.prototype.joinRoomByCustomId=function(e,t){var n=this;return void 0===t&&(t=!1),this._roomService.joinRoomByCustomId(e,this._user).then((function(e){return We(n,void 0,void 0,(function(){return Ye(this,(function(n){switch(n.label){case 0:return this._currentRoom=e.room,this._eventService.setCurrentRoom(this._currentRoom),this._eventService.setPreviousEventsCursor(e.previouseventscursor||""),t?[3,2]:[4,this._eventService.handleUpdates(e.eventscursor)];case 1:n.sent(),n.label=2;case 2:return[2,e]}}))}))}))},e.prototype.setNotificationReadStatusByChatEventId=function(e,t,n){var r=n||this._user?this._user.userid:"";return this._notificationServce.setNotificationReadStatusByChatEventId(e,r,t)},e.init=function(t,n){void 0===t&&(t={appId:""});var r=new e;return r.setConfig(t),n&&r.setEventHandlers(n),r},e}();Ve.ChatClient=ze;var Qe,Xe,Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.WebStatusString=Ze.WebStatusCode=Ze.Reaction=Ze.Kind=void 0,(Xe=Ze.Kind||(Ze.Kind={})).chat="chat.event",Xe.chatsubscription="chat.subscription",Xe.roomusereffects="chat.list.roomusereffects",Xe.room="chat.room",Xe.userroomsubscriptions="chat.list.userroomsubscriptions",Xe.notification="notification",Xe.bounce="chat.bounceuser",Xe.user="app.user",Xe.api="api.result",Xe.webhook="webhook.webhook",Xe.webhookevent="webhook.event",Xe.webhooklogs="list.webhook.logentries",Xe.webhookcommentpayload="webhook.payload.comment",Xe.webhookcommentreplypayload="webhook.payload.commentreply",Xe.chatcommand="chat.executecommand",Xe.conversation="comment.conversation",Xe.deletedconversation="delete.conversation",Xe.comment="comment.comment",Xe.deletedcomment="delete.comment",Xe.deletedroom="deleted.room",Xe.deleteduser="deleted.appuser",Xe.conversationlist="list.commentconversations",Xe.chatlist="list.chatevents",Xe.eventlist="list.events",Xe.roomlist="list.chatrooms",Xe.userlist="list.users",Xe.repliesbyparentidlist="list.repliesbyparentid",Xe.commentreplygrouplist="list.commentreplygroup",Xe.chatroomextendeddetails="chat.room.list.extendeddetails",Xe.conversationdetailslist="list.comment.conversation.details",(Ze.Reaction||(Ze.Reaction={})).like="like",(Qe=Ze.WebStatusCode||(Ze.WebStatusCode={}))[Qe.OK=200]="OK",Qe[Qe.NOT_FOUND=404]="NOT_FOUND",Qe[Qe.SERVER_ERROR=500]="SERVER_ERROR",(Ze.WebStatusString||(Ze.WebStatusString={})).OK="OK";var $e={};Object.defineProperty($e,"__esModule",{value:!0}),$e.getUrlConversationId=$e.getUrlCommentId=void 0,$e.getUrlCommentId=function(e){var t=e.id||e;return"string"!=typeof t?"":encodeURIComponent(t)},$e.getUrlConversationId=function(e){var t=e.conversationid||e;return"string"!=typeof t?"":encodeURIComponent(t)};var et={},tt=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},nt=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(et,"__esModule",{value:!0}),et.RestfulCommentService=void 0;var rt=function(e){var t=this;this._apiExt="comment/conversations",this.setConfig=function(e){return t._config=e,t._apiHeaders=f.getUrlEncodedHeaders(t._config.apiToken,t._config.userToken),t._jsonHeaders=f.getJSONHeaders(t._config.apiToken,t._config.userToken),e},this.setUserToken=function(e){t._config.userToken=e,t.setConfig(t._config)},this.setUserTokenRefreshFunction=function(e){t._config.userTokenRefreshFunction=e,t.setConfig(t._config)},this._requireUser=function(e){if(!e)throw new s.RequireUserError(m.MUST_SET_USER);if(!e.userid)throw new s.RequireUserError(m.USER_NEEDS_ID)},this._requireConversationId=function(e){if(!e)throw new s.ValidationError(m.NO_CONVERSATION_SET)},this._buildUserComment=function(e,t){var n=e;return"string"==typeof e&&(n={body:e}),Object.assign({},n,t)},this.getConversation=function(){return t._conversation},this.publishComment=function(e,n,r,o){t._requireConversationId(e);var i=o||n.replyto;t._requireUser(r||n);var s=t._buildUserComment(n,r);return i?t._makeReply(e,s,i):t._makeComment(e,s)},this._makeComment=function(e,n){var r={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments"),headers:t._jsonHeaders,data:n};return ye.stRequest(r).then((function(e){return e.data}))},this._makeReply=function(e,n,r){var i=r.id||r||n.replyto;if(!i||"string"!=typeof i)throw new s.ValidationError(m.MISSING_REPLYTO_ID);var a={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+i),headers:t._jsonHeaders,data:n};return ye.stRequest(a).then((function(e){return e.data})).catch((function(e){throw e}))},this.getComment=function(e,n){t._requireConversationId(e);var r=$e.getUrlCommentId(n),i={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+r),headers:t._jsonHeaders};return ye.stRequest(i).then((function(e){return e.data})).catch((function(e){if(404===e.response.status)return null;throw e}))},this._finalDelete=function(e,n,r){return tt(t,void 0,void 0,(function(){var t,r;return nt(this,(function(i){switch(i.label){case 0:return t=$e.getUrlCommentId(n),r={method:o.DELETE,url:f.buildAPI(this._config,this._apiExt+"/"+e+"/comments/"+t),headers:this._jsonHeaders},[4,ye.stRequest(r)];case 1:return[2,i.sent().data]}}))}))},this._markDeleted=function(e,n,r){return tt(t,void 0,void 0,(function(){var t,i;return nt(this,(function(s){return this._requireUser(r),t=$e.getUrlCommentId(n),i={method:o.PUT,url:f.buildAPI(this._config,this._apiExt+"/"+e+"/comments/"+t+"/setdeleted?userid="+r.userid+"&deleted=true&permanentifnoreplies=false"),headers:this._jsonHeaders},[2,ye.stRequest(i).then((function(e){var t=e.data;return{kind:Ze.Kind.deletedcomment,conversationid:t.conversationid,commentid:t.id,deletedComments:1}}))]}))}))},this.deleteComment=function(e,n,r,o){return t._requireConversationId(e),o?t._finalDelete(e,n,r):t._markDeleted(e,n,r)},this.updateComment=function(e,n){t._requireConversationId(e);var r=$e.getUrlCommentId(n);return ye.stRequest({method:o.PUT,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+r),headers:t._jsonHeaders,data:{body:n.body,userid:n.userid}}).then((function(e){return e.data}))},this.react=function(e,n,r,i,s){void 0===s&&(s=!0),t._requireConversationId(e),t._requireUser(r);var a=$e.getUrlCommentId(n),u={userid:r.userid,reaction:i,reacted:!!s},c={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+a+"/react"),headers:t._jsonHeaders,data:u};return ye.stRequest(c).then((function(e){return e.data}))},this.vote=function(e,n,r,i){t._requireConversationId(e),t._requireUser(r);var s=$e.getUrlCommentId(n),a={method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+s+"/vote"),headers:t._jsonHeaders,data:{vote:i,userid:r.userid}};return ye.stRequest(a).then((function(e){return e.data}))},this.report=function(e,n,r,i){t._requireConversationId(e),t._requireUser(r);var s=$e.getUrlCommentId(n);return ye.stRequest({method:o.POST,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+s+"/report"),headers:t._jsonHeaders,data:{reporttype:i,userid:r.userid}}).then((function(e){return e.data}))},this.getReplies=function(e,n,r){t._requireConversationId(e);var i=$e.getUrlCommentId(n),s=f.formify(r);return ye.stRequest({method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+e+"/comments/"+i+"/replies/?"+s),headers:t._jsonHeaders,data:r}).then((function(e){return{conversation:e.data.conversation,comments:e.data.comments}}))},this.listComments=function(e,n){if(!e)throw new s.ValidationError(m.MUST_SPECIFY_CONVERSATION);var r=$e.getUrlConversationId(e);t._requireConversationId(r);var i={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+r+"/comments",n),headers:t._jsonHeaders};return ye.stRequest(i).then((function(e){var t=e.data;return{conversation:t.conversation,comments:t.comments,cursor:t.cursor,more:t.more}}))},this.listRepliesBatch=function(e,n,r){void 0===r&&(r=50);var i=$e.getUrlConversationId(e);if(t._requireConversationId(i),!n||!n.length)throw new s.ValidationError("Must provide a list of parent comment IDs");var a={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+i+"/repliesbyparentidbatch",{parentids:n,childlimit:r}),headers:t._jsonHeaders};return ye.stRequest(a).then((function(e){return e.data}))},e&&this.setConfig(e)};et.RestfulCommentService=rt;var ot={},it=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},st=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.RestfulConversationService=void 0;var at=function(){function e(e){var t=this;this._apiExt="comment/conversations",this.request=ye.bindJWTUpdates(this),this.getCurrentUser=function(){return t._config.user},this.getUserToken=function(){return it(t,void 0,void 0,(function(){return st(this,(function(e){return[2,this._config.userToken||""]}))}))},this.refreshUserToken=function(){return it(t,void 0,void 0,(function(){return st(this,(function(e){return this._config.userTokenRefreshFunction?[2,this._config.userTokenRefreshFunction(this._config.userToken||"")]:[2,""]}))}))},this.setUser=function(e){t._config.user=e},this.setConfig=function(e){t._config=e,t._apiHeaders=f.getUrlEncodedHeaders(t._config.apiToken,t._config.userToken),t._jsonHeaders=f.getJSONHeaders(t._config.apiToken,t._config.userToken)},this.setUserToken=function(e){t._config.userToken=e,t.setConfig(t._config)},this.setUserTokenRefreshFunction=function(e){t._config.userTokenRefreshFunction=e,t.setConfig(t._config)},this.createConversation=function(e){var n={method:o.POST,url:f.buildAPI(t._config,t._apiExt),headers:t._jsonHeaders,data:e};return t.request(n).then((function(e){return e.data}))},this.getConversation=function(e){var n=$e.getUrlConversationId(e);if(!n)throw new Error("Must supply a conversationid to get a conversation");var r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return t.request(r).then((function(e){return e.data}))},this.reactToConversationTopic=function(e,n,r){void 0===n&&(n={reaction:"like",reacted:!0});var i=$e.getUrlConversationId(e),s=r||t._config.user,a=f.forceObjKeyOrString(s,"userid");if(!n)throw new Error("Must provide a ReactionCommand object to react or send nothing to do a default like");if(!a)throw new Error("Must send a userid to react to a conversation topic");if(!i)throw new Error("Must have a conversation ID to react to a conversation topic");var u={method:o.POST,url:f.buildAPI(t._config,"comment/conversations/"+i+"/react/"),headers:t._jsonHeaders,data:{reaction:n.reaction||"like",reacted:n.reacted||!0,userid:a}};return t.request(u).then((function(e){return e.data}))},this.getConversationByCustomId=function(e){var n=$e.getUrlConversationId(e,"customid"),r={method:o.GET,url:f.buildAPI(t._config,"comment/find/conversation/bycustomid?customid="+n),headers:t._jsonHeaders};return t.request(r).then((function(e){return e.data}))},this.deleteConversation=function(e){var n=$e.getUrlConversationId(e),r={method:o.DELETE,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return t.request(r)},this.listConversations=function(e){var n="";e&&(n="?"+f.formify(e));var r={method:o.GET,url:f.buildAPI(t._config,t._apiExt+"/"+n),headers:t._jsonHeaders};return t.request(r).then((function(e){return e.data}))},e&&this.setConfig(e)}return e.prototype.getTokenExp=function(){return 0},e.prototype.getConversationBatchDetails=function(e,t){var n=[].concat(e).map((function(e){return e.conversationid?e.conversationid:e})),r=Object.assign({},t||{}),i=[].concat(r.cid).join(","),s=[].concat(r.entities).join(","),a={method:o.GET,url:f.buildAPI(this._config,this._apiExt+"/details/batch?ids="+n.join(",")+(i?"&cid="+i:"")+(s?"&entities="+s:"")),headers:this._jsonHeaders};return this.request(a).then((function(e){return e.data}))},e}();ot.RestfulConversationService=at;var ut={},ct=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(He){i(He)}}function a(e){try{u(r.throw(e))}catch(He){i(He)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},dt=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(He){i=[6,He],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(ut,"__esModule",{value:!0}),ut.CommentClient=void 0;var ft=function(){function e(){var e=this;this._defaultCommentRequest={includechildren:!1},this.getConfig=function(){return e._config},this.getUserToken=function(){return ct(e,void 0,void 0,(function(){return dt(this,(function(e){return[2,this._config.userToken||""]}))}))},this.setUserToken=function(t){e._config.userToken=t,e.setConfig(e._config)},this.setUserTokenRefreshFunction=function(t){e._callbackDelegate?e._callbackDelegate.setCallback(t):e._callbackDelegate=new f.CallBackDelegate(e,t),e._config.userTokenRefreshFunction=e._callbackDelegate.callback,e.setConfig(e._config)},this.refreshUserToken=function(){return ct(e,void 0,void 0,(function(){var e;return dt(this,(function(t){switch(t.label){case 0:if(!this._config.userToken)throw new Error("You must set a user token before you can refresh it.  Also ensure that you set a refresh function");if(!this._config.userTokenRefreshFunction)throw new Error("You must set a refresh function in order to refresh a userToken. Also ensure that the user token JWT is properly set.");return[4,this._config.userTokenRefreshFunction(this._config.userToken)];case 1:return e=t.sent(),this.setUserToken(e),[2,e]}}))}))},this.setUser=function(t,n){e._user=t,n&&(e._config.userToken=n,e.setConfig(e._config))},this.getCurrentUser=function(){return e._user},this.setConfig=function(t,n,r){e._config=Object.assign({},o.DEFAULT_CONFIG,t),e._commentService&&!n||(e._commentService=n||new et.RestfulCommentService),e._conversationService&&!r||(e._conversationService=r||new ot.RestfulConversationService),e._userService||(e._userService=new Ie.RestfulUserService(e._config)),e._conversationService.setConfig(e._config),e._commentService.setConfig(e._config),t.user&&(e._user=t.user)},this.createConversation=function(t,n){return void 0===n&&(n=!0),ct(e,void 0,void 0,(function(){var e;return dt(this,(function(r){switch(r.label){case 0:return[4,this._conversationService.createConversation(t)];case 1:return e=r.sent(),n&&(this._currentConversation=e),[2,e]}}))}))},this.ensureConversation=function(t){return ct(e,void 0,void 0,(function(){var e=this;return dt(this,(function(n){return[2,this.getConversation(t).then((function(t){return e.setCurrentConversation(t),t})).catch((function(n){return e.createConversation(t,!0)}))]}))}))},this.setCurrentConversation=function(t){return e._currentConversation=t,e._currentConversation},this.getCurrentConversation=function(){return e._currentConversation},this.getConversation=function(t){return e._conversationService.getConversation(t)},this.reactToConversationTopic=function(t,n,r){return void 0===n&&(n={reaction:"like",reacted:!0}),e._conversationService.reactToConversationTopic(t,n||{},r||e._user)},this.deleteConversation=function(t){return e._conversationService.deleteConversation(t)},this.publishComment=function(t,n){var r=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.publishComment(r,t,e._user,n)},this.getComment=function(t){var n=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.getComment(n,t)},this.createOrUpdateUser=function(t,n){return void 0===n&&(n=!0),e._userService.createOrUpdateUser(t).then((function(t){return n&&(e._user=t),t}))},this.deleteComment=function(t,n){var r=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.deleteComment(r,t,e._user,n)},this.updateComment=function(t){var n=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.updateComment(n,t,e._user)},this.reactToComment=function(t,n){var r=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.react(r,t,e._user,n)},this.voteOnComment=function(t,n){var r=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.vote(r,t,e._user,n)},this.reportComment=function(t,n){var r=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.report(r,t,e._user,n)},this.getCommentReplies=function(t,n){var r=f.forceObjKeyOrString(e._currentConversation,"conversationid"),o=f.forceObjKeyOrString(t);return e._commentService.getReplies(r,o,n)},this.listRepliesBatch=function(t,n){void 0===n&&(n=50);var r=f.forceObjKeyOrString(e._currentConversation,"conversationid");return e._commentService.listRepliesBatch(r,t,n)},this.listComments=function(t,n){var r=f.forceObjKeyOrString(n||e._currentConversation,"conversationid"),o=Object.assign({},e._defaultCommentRequest,t);return e._commentService.listComments(r,o)},this.listConversations=function(t){return e._conversationService.listConversations(t)},this.setBanStatus=function(t,n){return e._userService.setBanStatus(t,n)},this.searchUsers=function(t,n,r){return e._userService.searchUsers(t,n,r)},this.listUsers=function(t){return e._userService.listUsers(t)},this.deleteUser=function(t){return e._userService.deleteUser(t)},this.getUserDetails=function(t){return e._userService.getUserDetails(t)},this.getConversationBatchDetails=function(t,n){return e._conversationService.getConversationBatchDetails(t,n)}}return e.init=function(t,n,r,o){var i=new e;return i.setConfig(t,r,o),n&&i.setCurrentConversation(n),i},e.prototype.getTokenExp=function(){return 0},e.prototype.getConversationByCustomId=function(e){return this._conversationService.getConversationByCustomId(e)},e}();ut.CommentClient=ft;var lt={};Object.defineProperty(lt,"__esModule",{value:!0}),lt.CommentModeration=lt.Vote=lt.ListSortDirection=lt.CommentSortMethod=lt.CommentType=lt.ModerationType=lt.Kind=void 0,Object.defineProperty(lt,"Kind",{enumerable:!0,get:function(){return Ze.Kind}}),Object.defineProperty(lt,"ModerationType",{enumerable:!0,get:function(){return we.ModerationType}}),(lt.CommentType||(lt.CommentType={})).comment="comment";var ht,vt,pt,mt=function(){function e(){}return e.reaction=function(e){return"reaction-"+e},e}();lt.CommentSortMethod=mt,(pt=lt.ListSortDirection||(lt.ListSortDirection={})).forward="forward",pt.backward="backward",(vt=lt.Vote||(lt.Vote={})).up="up",vt.down="down",vt.none="",(ht=lt.CommentModeration||(lt.CommentModeration={})).flagged="flagged",ht.rejected="rejected",ht.approved="approved",function(e){if(e){var t=e.ChatClient||Ve.default||Ve.ChatClient||Ve,n=e.CommentClient||ut.default||ut.CommentClient||ut;e.ChatClient=t,e.CommentClient=n,e.SportsTalk={},e.Conversation={},e.SportsTalk.chat={},e.SportsTalk.chat.Models=r,e.SportsTalk.comments={},e.SportsTalk.common={},e.SportsTalk.common.Models=Ze,e.SportsTalk.comments.Models=lt}console.log("Chat and commenting powered by Sportstalk247")}(window)}();